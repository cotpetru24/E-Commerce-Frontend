<div class="product-list-container">
  <!-- Header Section -->
  <div class="page-header">
    <div class="container">
      <h1 class="page-title">{{ getPageTitle() }}</h1>
      <p class="page-subtitle">{{ getPageSubtitle() }}</p>
    </div>
  </div>

  <div class="container">
    <div class="product-layout">
      <!-- Filters Sidebar -->
      <aside class="filters-sidebar mb-5">
        <div class="filters-header">
          <h3>Filters</h3>
          <button class="btn btn-primary btn-sm" (click)="clearFilters()">Clear All</button>
        </div>

        <!-- Search Filter -->
        <div class="filter-section">
          <h4>Search</h4>
          <div class="input-group">
            <input [(ngModel)]="productFilterDto.SearchTerm" type="search" class="form-control" placeholder="Search..."
              title="Search" (input)="onSearchTermClear($event)" (keydown.enter)="getProducts()">
            <button class=" btn btn-outline-secondary" type="button" title="Search button" (click)="getProducts()">
              <i class="bi bi-search"></i>
            </button>
          </div>
        </div>


        <!-- Category Filter -->
        <div class="filter-section">
          <h4>Gender</h4>

          <div class="input-group mb-2" *ngFor="let gender of audienceOptions">
            <div class="input-group-text">
              <input class="form-check-input mt-0" type="radio" name="gender" [value]="gender"
                [(ngModel)]="productFilterDto.Audience" (change)="getProducts()" [attr.aria-label]="'Select ' + gender"
                title="Select gender">
            </div>
            <input type="text" class="form-control" [value]="gender | titlecase" aria-label="Gender label" readonly>
          </div>
        </div>


        <!-- Brand Filter -->
        <div class="filter-section">
          <h4>Brand</h4>
          <label for="selectedBrand" class="form-label">Select brand</label>
          <select id="selectedBrand" class="form-select" [(ngModel)]="productFilterDto.Brand" (change)="getProducts()">
            <option value="">All Brands</option>
            <option *ngFor="let brand of availableBrands" [value]="brand">
              {{brand}}
            </option>
          </select>
        </div>

        <!-- Price Range Filter -->
        <div class="filter-section">
          <h4 class="mb-3">Price Range</h4>
          <div class="price-range">
            <div class="mb-3">
              <label for="minPrice" class="form-label">Min Price</label>
              <input type="number" name="minPrice" id="minPrice" class="form-control" placeholder="0"
                aria-describedby="minPriceHelp" [(ngModel)]="productFilterDto.MinPrice" (input)="getProducts()" />
              <div id="minPriceHelp" class="visually-hidden">Enter minimum price</div>
            </div>

            <div class="mb-3">
              <label for="maxPrice" class="form-label">Max Price</label>
              <input type="number" name="maxPrice" id="maxPrice" class="form-control" placeholder="1000"
                aria-describedby="maxPriceHelper" [(ngModel)]="productFilterDto.MaxPrice" (input)="getProducts()" />
              <div id="maxPriceHelper" class="visually-hidden">Enter maximum price</div>
            </div>
          </div>

        </div>

        <!-- Sort Options -->
        <div class="filter-section">
          <h4>Sort By</h4>
          <label for="sortSelect" class="form-label">Sort</label>
          <select id="sortSelect" class="form-select" [(ngModel)]="productFilterDto.SortBy" (change)="getProducts()">
            <option value="" disabled selected>Select sorting option</option>
            <option *ngFor="let option of sortByOptions" [value]="option.value">
              {{option.label}}
            </option>

          </select>
        </div>

      </aside>

      <!-- Products Grid -->
      <main class="products-main mb-5">
        <!-- Results Header -->
        <div class="results-header">
          <div class="results-info">
            <span>{{ products.length }} products found</span>
            <span *ngIf="productFilterDto.Audience || productFilterDto.Brand || productFilterDto.SearchTerm"
              class="active-filters">
              (filtered)
            </span>
          </div>
          <div class="view-options">
            <button class="btn btn-outline-secondary" [class.active]="viewMode === 'grid'" (click)="setViewMode('grid')"
              title="Grid view button">
              <i class="bi bi-grid"></i>
            </button>
            <button class="btn btn-outline-secondary" [class.active]="viewMode === 'list'" (click)="setViewMode('list')"
              title="List view button">
              <i class="bi bi-list"></i>
            </button>
          </div>
        </div>

        <!-- Products Grid/List -->
        <div class="products-container" [class.list-view]="viewMode === 'list'">
          <div class="card-header" *ngFor="let product of products" [class.list-card]="viewMode === 'list'">
            <div class="product-image">
              <img [src]="'/assets/'+product.imagePath" [alt]="product.name" title="Product image" />
              <div class="product-overlay">
                <button class="btn btn-light btn-sm quick-view-btn" (click)="quickView(product)"
                  title="Quick view button">
                  <i class="bi bi-eye"></i>
                </button>
                <button class="btn btn-primary btn-sm add-to-cart-btn" (click)="addToCart(product)"
                  title="Add to cart button">
                  <i class="bi bi-cart-plus"></i>
                </button>
              </div>
              <div class="product-badges">
                <span class="audience-badge" [class]="product.audience">{{ product.audience
                  }}</span>
                <!-- <span class="stock-badge" [class.in-stock]="product.stock > 0"
                  [class.out-of-stock]="product.stock === 0">
                  {{ product.stock > 0 ? 'In Stock' : 'Out of Stock' }}
                </span> -->
              </div>
            </div>

            <div class="card-body">
              <div class="product-info">
                <h3 class="product-name">{{ product.name }}</h3>
                <p class="product-brand">{{ product.brandName }}</p>
                <p class="product-description">{{ product.description }}</p>
                <div class="product-price">
                  <span class="price">Â£{{ product.price }}</span>
                  <span class="stock-badge" [class.in-stock]="product.stock > 0"
                    [class.out-of-stock]="product.stock === 0">
                    {{ product.stock > 0 ? 'In Stock' : 'Out of Stock' }}
                  </span>
                  <!-- <span class="stock-count" *ngIf="product.stock > 0">
                    {{ product.stock }} left
                  </span> -->
                </div>
              </div>
            </div>

            <div class="card-footer d-flex justify-content-end">
              <button class="btn btn-outline-primary m-2" [routerLink]="['/products/details', product.id]">
                View Details
              </button>
              <button class="btn btn-primary m-2" [disabled]="product.stock === 0" (click)="addToCart(product)">
                Add to Cart
              </button>
            </div>
          </div>
        </div>

        <!-- No Results -->
        <div class="no-results" *ngIf="products.length === 0">
          <i class="bi bi-search"></i>
          <h3>No products found</h3>
          <p>Try adjusting your filters or search terms</p>
          <button class="btn btn-primary" (click)="clearFilters()">
            Clear Filters
          </button>
        </div>
      </main>
    </div>
  </div>
</div>