<div class="container mt-4">
  <div class="row">
    <div class="col-lg-3">
      <!-- User Profile Card -->
      <div class="card shadow-sm mb-4">
        <div class="card-body text-center">
          <div class="mb-3">
            <div class="position-relative d-inline-block">
              <img [src]="userProfile.avatar || 'assets/images/default-avatar.png'" 
                   alt="Profile Picture" 
                   class="rounded-circle" 
                   style="width: 100px; height: 100px; object-fit: cover;">
              <button class="btn btn-sm btn-primary position-absolute bottom-0 end-0" 
                      (click)="editProfilePicture()">
                <i class="bi bi-camera"></i>
              </button>
            </div>
          </div>
          <h5 class="card-title">{{ userProfile.firstName }} {{ userProfile.lastName }}</h5>
          <p class="text-muted">{{ userProfile.email }}</p>
          <div class="badge bg-success mb-2">Member since {{ userProfile.joinDate | date:'MMM yyyy' }}</div>
          <button class="btn btn-outline-primary btn-sm" (click)="editProfile()">
            <i class="bi bi-pencil me-2"></i>Edit Profile
          </button>
        </div>
      </div>

      <!-- Navigation Menu -->
      <div class="card shadow-sm">
        <div class="card-header bg-light">
          <h6 class="mb-0">
            <i class="bi bi-person-gear me-2"></i>Account Menu
          </h6>
        </div>
        <div class="list-group list-group-flush">
          <a class="list-group-item list-group-item-action" 
             [routerLink]="['/account']" 
             routerLinkActive="active">
            <i class="bi bi-person me-2"></i>Profile
          </a>
          <a class="list-group-item list-group-item-action" 
             [routerLink]="['/account/orders']" 
             routerLinkActive="active">
            <i class="bi bi-bag me-2"></i>My Orders
          </a>
          <a class="list-group-item list-group-item-action" 
             [routerLink]="['/account/wishlist']" 
             routerLinkActive="active">
            <i class="bi bi-heart me-2"></i>Wishlist
          </a>
          <a class="list-group-item list-group-item-action" 
             [routerLink]="['/account/addresses']" 
             routerLinkActive="active">
            <i class="bi bi-geo-alt me-2"></i>Addresses
          </a>
          <a class="list-group-item list-group-item-action" 
             [routerLink]="['/account/payment-methods']" 
             routerLinkActive="active">
            <i class="bi bi-credit-card me-2"></i>Payment Methods
          </a>
          <a class="list-group-item list-group-item-action" 
             [routerLink]="['/account/settings']" 
             routerLinkActive="active">
            <i class="bi bi-gear me-2"></i>Settings
          </a>
          <a class="list-group-item list-group-item-action text-danger" 
             (click)="logout()">
            <i class="bi bi-box-arrow-right me-2"></i>Logout
          </a>
        </div>
      </div>
    </div>

    <div class="col-lg-9">
      <!-- Account Overview -->
      <div class="card shadow-sm mb-4">
        <div class="card-header bg-primary text-white">
          <h5 class="mb-0">
            <i class="bi bi-speedometer2 me-2"></i>Account Overview
          </h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-3 mb-3">
              <div class="text-center">
                <div class="h3 text-primary">{{ accountStats.totalOrders }}</div>
                <small class="text-muted">Total Orders</small>
              </div>
            </div>
            <div class="col-md-3 mb-3">
              <div class="text-center">
                <div class="h3 text-success">{{ accountStats.completedOrders }}</div>
                <small class="text-muted">Completed</small>
              </div>
            </div>
            <div class="col-md-3 mb-3">
              <div class="text-center">
                <div class="h3 text-warning">{{ accountStats.pendingOrders }}</div>
                <small class="text-muted">Pending</small>
              </div>
            </div>
            <div class="col-md-3 mb-3">
              <div class="text-center">
                <div class="h3 text-info">{{ accountStats.wishlistItems }}</div>
                <small class="text-muted">Wishlist Items</small>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Recent Orders -->
      <div class="card shadow-sm mb-4">
        <div class="card-header bg-light d-flex justify-content-between align-items-center">
          <h5 class="mb-0">
            <i class="bi bi-clock-history me-2"></i>Recent Orders
          </h5>
          <a routerLink="/account/orders" class="btn btn-outline-primary btn-sm">
            View All
          </a>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th>Order ID</th>
                  <th>Date</th>
                  <th>Status</th>
                  <th>Total</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let order of recentOrders">
                  <td>
                    <strong>#{{ order.orderId }}</strong>
                  </td>
                  <td>{{ order.orderDate | date:'MMM dd, yyyy' }}</td>
                  <td>
                    <span class="badge" [ngClass]="getStatusBadgeClass(order.status)">
                      {{ order.status }}
                    </span>
                  </td>
                  <td>Â£{{ order.total | number:'1.2-2' }}</td>
                  <td>
                    <button class="btn btn-outline-primary btn-sm" (click)="viewOrder(order.orderId)">
                      <i class="bi bi-eye"></i>
                    </button>
                  </td>
                </tr>
                <tr *ngIf="recentOrders.length === 0">
                  <td colspan="5" class="text-center text-muted">
                    <i class="bi bi-bag-x display-6"></i>
                    <p class="mt-2">No orders yet</p>
                    <a routerLink="/products" class="btn btn-primary btn-sm">
                      Start Shopping
                    </a>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Account Settings -->
      <div class="card shadow-sm">
        <div class="card-header bg-light">
          <h5 class="mb-0">
            <i class="bi bi-shield-check me-2"></i>Account Security
          </h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-6 mb-3">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <h6 class="mb-1">Password</h6>
                  <small class="text-muted">Last changed: {{ userProfile.lastPasswordChange | date:'MMM dd, yyyy' }}</small>
                </div>
                <button class="btn btn-outline-primary btn-sm" (click)="changePassword()">
                  Change
                </button>
              </div>
            </div>
            <div class="col-md-6 mb-3">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <h6 class="mb-1">Two-Factor Authentication</h6>
                  <small class="text-muted" [ngClass]="{'text-success': userProfile.twoFactorEnabled, 'text-danger': !userProfile.twoFactorEnabled}">
                    {{ userProfile.twoFactorEnabled ? 'Enabled' : 'Disabled' }}
                  </small>
                </div>
                <button class="btn btn-outline-primary btn-sm" (click)="toggleTwoFactor()">
                  {{ userProfile.twoFactorEnabled ? 'Disable' : 'Enable' }}
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div> 