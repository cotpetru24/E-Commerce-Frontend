<div class="checkout-container pb-5">
  <!-- Page Header -->
  @if (!isLoading && userProfile) {
    <div class="page-header mb-5">
    <div class="container">
      <div class="header-content">
        <div class="header-main">
          <h1 class="page-title">
            <i class="bi bi-person-circle me-2"></i>My Account
          </h1>
          <p class="page-subtitle">Manage your profile and account settings</p>
        </div>
      </div>
    </div>
    </div>
  }

  <!-- Loading Spinner -->
  @if (isLoading) {
    <div class="container">
    <div class="loading-container">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-2">Loading your account...</p>
    </div>
    </div>
  }

  <!-- Main Content -->
  @if (!isLoading && userProfile) {
    <div class="container">
    <div class="account-layout">
      <!-- Main Content -->
      <div class="account-main">

        <!-- Profile Edit Form -->
        @if (isEditing) {
          <div class="form-card">
          <div class="card-header">
            <h3 class="card-title">
              <i class="bi bi-pencil me-2"></i>Edit Profile
            </h3>
          </div>
          <div class="card-content">
            <form (ngSubmit)="saveProfile()" class="account-form">
              <div class="form-row">
                <div class="form-group">
                  <label for="firstName" class="form-label">First Name</label>
                  <input type="text" class="form-control" id="firstName" 
                         [(ngModel)]="editForm.firstName" name="firstName" required>
                </div>
                <div class="form-group">
                  <label for="lastName" class="form-label">Last Name</label>
                  <input type="text" class="form-control" id="lastName" 
                         [(ngModel)]="editForm.lastName" name="lastName" required>
                </div>
              </div>
              <div class="form-group">
                <label for="email" class="form-label">Email</label>
                <input type="email" class="form-control" id="email" 
                       [(ngModel)]="editForm.email" name="email" required>
              </div>
              <div class="form-actions">
                <button type="submit" class="btn btn-primary mt-4">
                  <i class="bi bi-check-lg me-2"></i>Save Changes
                </button>

              </div>
            </form>
          </div>
          </div>
        }

        <!-- Change Password Form -->
        @if (isChangingPassword) {
          <div class="form-card">
          <div class="card-header">
            <h3 class="card-title">
              <i class="bi bi-shield-lock me-2"></i>Change Password
            </h3>
          </div>
          <div class="card-content">
            <form (ngSubmit)="savePassword()" class="account-form">
              <div class="form-group">
                <label for="currentPassword" class="form-label">Current Password</label>
                <input type="password" class="form-control" id="currentPassword" 
                       [(ngModel)]="passwordForm.currentPassword" name="currentPassword" required>
              </div>
              <div class="form-group">
                <label for="newPassword" class="form-label">New Password</label>
                <input type="password" class="form-control" id="newPassword" 
                       [(ngModel)]="passwordForm.newPassword" name="newPassword" required>
              </div>
              <div class="form-group">
                <label for="confirmPassword" class="form-label">Confirm New Password</label>
                <input type="password" class="form-control" id="confirmPassword" 
                       [(ngModel)]="passwordForm.confirmPassword" name="confirmPassword" required>
              </div>
              <div class="form-actions">
                <button type="submit" class="btn btn-primary mt-4">
                  <i class="bi bi-shield-check me-2"></i>Change Password
                </button>

              </div>
            </form>
          </div>
          </div>
        }
      </div>

      <!-- Account Sidebar -->
      <div class="account-sidebar">
        <!-- User Profile Card -->
        <div class="profile-card">
          <div class="profile-header">
            <div class="profile-avatar">
              <div class="avatar-circle">
                <i class="bi bi-person-fill"></i>
              </div>
            </div>
            <div class="profile-info">
              <h4 class="profile-name">{{ userProfile.firstName }} {{ userProfile.lastName }}</h4>
              <p class="profile-email">{{ userProfile.email }}</p>
              <div class="profile-membership">
                <i class="bi bi-calendar-check me-2"></i>
                <span>Member since {{ userProfile.joinDate | date:'MMM yyyy' }}</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Navigation Menu -->
        <div class="nav-card">
          <div class="nav-header">
            <h5>
              <i class="bi bi-person-gear me-2"></i>Account Menu
            </h5>
          </div>
          <div class="nav-menu">
            <button class="nav-item" (click)="startEditing()" [class.active]="isEditing">
              <i class="bi bi-person me-2"></i>Edit Profile
            </button>
            <button class="nav-item" (click)="startChangingPassword()" [class.active]="isChangingPassword">
              <i class="bi bi-shield-lock me-2"></i>Change Password
            </button>
          </div>
        </div>
      </div>
    </div>
    </div>
  }
</div> 